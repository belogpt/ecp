<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>Инструкция по программе «Визуализация ЭЦП в PDF»</title>
  <style>
    :root {
      color-scheme: light dark;
      --bg: #fafafa;
      --text: #1f1f1f;
      --heading: #0f172a;
      --muted: #d9d9d9;
      --accent: #0a69c5;
      --panel-bg: #eef3ff;
      --panel-border: #cdd9ff;
      --kbd-bg: #f5f5f5;
      --kbd-border: #b6b6b6;
      --code-bg: #f1f1f1;
      --note-bg: #fff8e5;
      --ok-bg: #e8f5e9;
      --bad-bg: #ffebee;
    }

    @media (prefers-color-scheme: dark) {
      :root {
        --bg: #0f1115;
        --text: #e5e7eb;
        --heading: #f8fafc;
        --muted: #2d3748;
        --accent: #7cb6ff;
        --panel-bg: #182235;
        --panel-border: #294064;
        --kbd-bg: #1f2937;
        --kbd-border: #4b5563;
        --code-bg: #1f2937;
        --note-bg: #2d2410;
        --ok-bg: #1e2f21;
        --bad-bg: #321717;
      }
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, sans-serif;
      margin: 0;
      padding: 0 24px 32px;
      background-color: var(--bg);
      color: var(--text);
      line-height: 1.5;
    }
    h1, h2, h3 {
      color: var(--heading);
    }
    h1 {
      margin-top: 24px;
      border-bottom: 2px solid var(--muted);
      padding-bottom: 8px;
    }
    h2 {
      margin-top: 24px;
      border-left: 4px solid var(--accent);
      padding-left: 8px;
    }
    h3 {
      margin-top: 16px;
    }
    .toc {
      background: var(--panel-bg);
      border: 1px solid var(--panel-border);
      border-radius: 6px;
      padding: 12px 16px;
      margin: 16px 0 24px;
      font-size: 0.95rem;
    }
    .toc ul {
      margin: 4px 0;
      padding-left: 18px;
    }
    .kbd {
      display: inline-block;
      padding: 1px 5px;
      margin: 0 2px;
      border-radius: 3px;
      border: 1px solid var(--kbd-border);
      background: var(--kbd-bg);
      font-size: 0.9em;
      font-family: Consolas, "Courier New", monospace;
    }
    code {
      font-family: Consolas, "Courier New", monospace;
      background: var(--code-bg);
      padding: 1px 4px;
      border-radius: 3px;
    }
    .note {
      border-left: 4px solid #ffa500;
      background: var(--note-bg);
      padding: 8px 12px;
      margin: 12px 0;
      font-size: 0.95rem;
    }
    .ok {
      border-left: 4px solid #4caf50;
      background: var(--ok-bg);
      padding: 8px 12px;
      margin: 12px 0;
      font-size: 0.95rem;
    }
    .bad {
      border-left: 4px solid #f44336;
      background: var(--bad-bg);
      padding: 8px 12px;
      margin: 12px 0;
      font-size: 0.95rem;
    }
    ul {
      margin-top: 4px;
      margin-bottom: 4px;
    }
  </style>
</head>
<body>

<h1>Инструкция по программе «Визуализация ЭЦП в PDF»</h1>

<p>
  Эта программа предназначена для того, чтобы <b>наглядно увидеть и зафиксировать на PDF-документе</b>
  сведения об электронной подписи (ЭЦП).
</p>

<div class="note">
  Инструкция автоматически подстраивается под светлую или тёмную тему системы, чтобы заголовки и текст
  оставались читаемыми на любом фоне. Если цвета не обновились, обновите окно справки.
</div>

<div class="toc">
  <b>Содержание</b>
  <ul>
    <li><a href="#purpose">1. Назначение и общая схема работы</a></li>
    <li><a href="#quickstart">2. Быстрый старт (короткая инструкция)</a></li>
    <li><a href="#ui">3. Описание интерфейса</a></li>
    <li><a href="#files">4. Добавление файлов</a></li>
    <li><a href="#matching">5. Поиск и проверка подписи</a></li>
    <li><a href="#pages">6. Выбор страницы и навигация</a></li>
    <li><a href="#stamp">7. Штамп ЭЦП на странице</a></li>
    <li><a href="#save">8. Сохранение PDF с ЭЦП</a></li>
    <li><a href="#header">9. Настройки шапки штампа</a></li>
    <li><a href="#nosign">10. Файлы без подписи</a></li>
    <li><a href="#menu">11. Меню «Файл», «Настройки» и «Помощь»</a></li>
    <li><a href="#faq">12. Частые вопросы</a></li>
  </ul>
</div>

<h2 id="purpose">1. Назначение и общая схема работы</h2>

<p>
  Программа помогает:
</p>
<ul>
  <li>проверить электронную подпись к PDF-документу;</li>
  <li>узнать серийный номер сертификата, владельца, срок действия, время подписи и статус;</li>
  <li>добавить <b>штамп с этими сведениями</b> на выбранную страницу PDF;</li>
  <li>сохранить новый PDF с уже «визуализированной» подписью.</li>
</ul>

<div class="note">
  Исходные PDF-файлы <b>не изменяются</b>. Для каждого документа создаётся новый файл
  с именем вида <code>ИмяФайла_ЭЦП_ДД.ММ.ГГГГ_ЧЧ.ММ.СС.pdf</code>.
</div>

<h2 id="quickstart">2. Быстрый старт (короткая инструкция)</h2>

<ol>
  <li>Запустите программу через ярлык или файл приложения.</li>
  <li>Нажмите <b>«Добавить файлы…»</b> и выберите ваши PDF и файлы подписи (<code>.p7s</code>),<br>
      или нажмите <b>«Добавить папку…»</b>, чтобы загрузить целую папку.</li>
  <li>Выберите нужный документ в левом списке.</li>
  <li>Убедитесь, что справа статус подписи зелёный и подпись действительна.</li>
  <li>Выберите страницу по миниатюре (если их несколько).</li>
  <li>Перетащите штамп в нужное место и при необходимости измените его размер.</li>
  <li>Выберите, где сохранять файлы:
    <ul>
      <li>включите <b>«Сохранять файл в исходное месторасположение»</b>,<br>
          или выберите общую папку сохранения.</li>
    </ul>
  </li>
  <li>Нажмите <b>«Сохранить файл с ЭЦП»</b>.</li>
  <li>Программа автоматически перейдёт к следующему документу.</li>
</ol>

<h2 id="ui">3. Описание интерфейса</h2>

<p>Главное окно условно делится на четыре области:</p>

<ul>
  <li><b>Слева</b> — список загруженных PDF-файлов.</li>
  <li><b>Слева по центру</b> — миниатюры страниц выбранного документа.</li>
  <li><b>По центру</b> — окно просмотра страницы и размещения штампа.</li>
  <li><b>Справа</b> — сведения о сертификате и настройки сохранения.</li>
</ul>

<p>Внизу окна отображается строка состояния с подсказками и прогрессом обработки.</p>

<h2 id="files">4. Добавление файлов</h2>

<h3>4.1. Перетаскивание мышью</h3>

<p>
  Вы можете просто перетащить мышью один или несколько файлов в окно программы.
  Поддерживаются:
</p>
<ul>
  <li>PDF-файлы (<code>.pdf</code>);</li>
  <li>файлы подписи (<code>.p7s</code>).</li>
</ul>

<p>
  Порядок не важен: можно добавить сначала PDF, потом подписи, или наоборот,
  а также смешанные наборы файлов.
</p>

<h3>4.2. Кнопка «Добавить файлы…»</h3>

<p>
  Нажмите кнопку <b>«Добавить файлы…»</b> (левая часть окна) и выберите один или несколько файлов.
  Программа загрузит их и попытается сопоставить подписи с документами.
</p>

<h3>4.3. Кнопка «Добавить папку…»</h3>

<p>
  Нажмите <b>«Добавить папку…»</b> и выберите каталог. Программа найдёт все <code>.pdf</code> и <code>.p7s</code>
  во всех вложенных папках и добавит их в список.
</p>

<p>
  Во время обработки внизу видно сообщение вида:
  <br><code>Обработка файла 3 из 10: имя_файла.pdf</code>
</p>

<h3>4.4. Удаление документов</h3>

<p>
  Чтобы удалить документ из списка, выберите его слева и нажмите <b>«Удалить выбранный»</b>.
  PDF-файл на диске при этом не удаляется, удаляется только запись из программы.
</p>

<h2 id="matching">5. Поиск и проверка подписи</h2>

<p>
  После загрузки файлов программа автоматически пытается подобрать к каждому PDF подходящий
  файл подписи <code>.p7s</code>:
</p>
<ul>
  <li>в первую очередь рассматриваются подписи из той же папки, что и документ;</li>
  <li>затем — подписи из других папок;</li>
  <li>для каждой пары «PDF + P7S» выполняется проверка соответствия (хэш документа и др.).</li>
</ul>

<p>
  Результат для каждого PDF отображается в левом списке:
</p>
<ul>
  <li><b>«(подпись найдена)»</b> — для документа найдена корректная подпись;</li>
  <li><b>«(нет файла подписи)»</b> — подходящая подпись не найдена.</li>
</ul>

<p>
  При выборе документа справа отображаются поля:
</p>
<ul>
  <li><b>Сертификат</b> — серийный номер сертификата;</li>
  <li><b>Владелец</b> — ФИО или организация;</li>
  <li><b>Время подписи</b> — дата и время подписания документа;</li>
  <li><b>Действителен</b> — срок действия сертификата (с / по);</li>
  <li><b>Статус подписи</b> — результат проверки.</li>
</ul>

<div class="ok">
  <b>Зелёный статус</b> — подпись действительна и соответствует документу. Штамп доступен.
</div>

<div class="note">
  <b>Оранжевый статус</b> — подпись не найдена. Штамп не будет отображаться для этого файла.
</div>

<div class="bad">
  <b>Красный статус</b> — ошибка проверки, подпись не подтверждена или сертификат просрочен.
  Штамп не используется, сохранить файл с ЭЦП нельзя.
</div>

<h2 id="pages">6. Выбор страницы и навигация</h2>

<p>
  Для выбранного документа во второй колонке отображаются миниатюры его страниц.
  Панель миниатюр всегда видна, даже если страница всего одна.
</p>

<ul>
  <li>щелчок по миниатюре — переход на соответствующую страницу;</li>
  <li>текущая страница выделена.</li>
</ul>

<p>
  При переключении на другой документ программа всегда показывает <b>первую страницу</b>
  этого PDF.
</p>

<h3>Управление просмотром страницы</h3>

<ul>
  <li>масштабирование: зажмите <span class="kbd">Ctrl</span> и крутите колесо мыши;</li>
  <li>перемещение (панорамирование): зажмите <span class="kbd">Пробел</span> и левую кнопку мыши,
      двигайте мышь.</li>
</ul>

<h2 id="stamp">7. Штамп ЭЦП на странице</h2>

<p>
  Если у документа найдена корректная ЭЦП, на странице отображается прямоугольник — область штампа.
  Внутри него показывается отрендеренная картинка штампа с:
</p>
<ul>
  <li>чёрной шапкой «Документ подписан электронной подписью»;</li>
  <li>при наличии — логотипом и текстом шапки (до 3 строк);</li>
  <li>ниже — сведениями: Сертификат, Владелец, Действителен, при необходимости Время подписи.</li>
</ul>

<h3>Перемещение и изменение размера</h3>

<ul>
  <li>Чтобы переместить штамп — потяните мышью за его область.</li>
  <li>Чтобы изменить размер — потяните за синюю квадратную ручку в правом нижнем углу.</li>
  <li>Пропорции штампа сохраняются, то есть он масштабируется целиком вместе с текстом.</li>
</ul>

<p>
  Положение и размер штампа запоминаются и используются для следующих документов.
</p>

<h2 id="save">8. Сохранение PDF с ЭЦП</h2>

<h3>8.1. Папка сохранения</h3>

<p>
  В правой части окна, в разделе «Сохранение», доступны настройки:
</p>

<ul>
  <li>поле <b>«Папка сохранения»</b> и кнопка «…» — выбирается общая папка, если не используется
      сохранение в исходное месторасположение;</li>
  <li>флажок <b>«Сохранять файл в исходное месторасположение»</b>:
    <ul>
      <li>если включен — новый PDF будет сохраняться рядом с исходным документом;</li>
      <li>если выключен — все сохранённые файлы будут попадать в выбранную общую папку.</li>
    </ul>
  </li>
</ul>

<p>
  Имя создаваемого файла имеет вид:
  <br><code>ИмяФайла_ЭЦП_ДД.ММ.ГГГГ_ЧЧ.ММ.СС.pdf</code>
</p>

<h3>8.2. Время подписи на штампе</h3>

<p>
  Флажок <b>«Показывать время подписи на штампе»</b> определяет, будет ли строка с датой/временем
  подписи выводиться прямо в штампе. Эта настройка сохраняется между запусками.
</p>

<h3>8.3. Процесс сохранения</h3>

<ol>
  <li>Выберите документ слева и нужную страницу по миниатюре.</li>
  <li>Убедитесь, что статус подписи зелёный и подпись действительна.</li>
  <li>Разместите штамп в нужном месте и отмасштабируйте при необходимости.</li>
  <li>Настройте папку сохранения (исходная или общая).</li>
  <li>Нажмите <b>«Сохранить файл с ЭЦП»</b>.</li>
</ol>

<p>
  После успешного сохранения:
</p>
<ul>
  <li>справа внизу отображается путь к созданному файлу;</li>
  <li>в списке документов слева перед именем появляется зелёная галочка <b>✔</b>;</li>
  <li>автоматически выбирается следующий документ.</li>
</ul>

<h2 id="header">9. Настройки шапки штампа</h2>

<p>
  В меню <b>«Настройки → Шапка штампа…»</b> можно изменить внешний вид верхней части штампа.
</p>

Возможности:
<ul>
  <li>выбрать картинку-логотип (PNG, квадратная);</li>
  <li>задать текст шапки в одном многострочном поле — он автоматически разбивается максимум на 3 строки;</li>
  <li>кнопкой «Удалить изображение и текст» сбросить эти настройки.</li>
</ul>

<p>
  Особенности:
</p>
<ul>
  <li>если логотип не задан, место под картинку и три строки шапки не рисуется;</li>
  <li>если текста много, он может обрезаться по ширине и не выходить за рамки штампа;</li>
  <li>логотип по высоте подгоняется так, чтобы занимать те же три строки по высоте.</li>
</ul>

<h2 id="nosign">10. Файлы без подписи</h2>

<p>
  Если для PDF не найдена подходящая подпись или подпись не проходит проверку, то:
</p>
<ul>
  <li>в статусе справа будет указано, что подпись отсутствует или не подтверждена;</li>
  <li>штамп на странице не отображается;</li>
  <li>кнопка <b>«Сохранить файл с ЭЦП»</b> становится недоступной.</li>
</ul>

<p>
  Это защищает от случайного добавления штампа к документу, для которого нет
  корректной электронной подписи.
</p>

<h2 id="menu">11. Меню «Файл», «Настройки» и «Помощь»</h2>

<h3>Меню «Файл»</h3>
<ul>
  <li><b>Выйти</b> — закрыть программу.</li>
</ul>

<h3>Меню «Настройки»</h3>
<ul>
  <li><b>Шапка штампа…</b> — настройка логотипа и текста в верхней части штампа.</li>
</ul>

<h3>Меню «Помощь»</h3>
<ul>
  <li><b>Инструкция</b> — открывает это окно со справкой.</li>
  <li><b>О программе</b> — показывает автора, номер версии и дату создания.</li>
</ul>

<h2 id="faq">12. Частые вопросы</h2>

<h3>Что делать, если программа пишет «нет файла подписи»?</h3>
<ul>
  <li>Убедитесь, что файл подписи <code>.p7s</code> действительно относится к этому PDF.</li>
  <li>Добавьте и PDF, и подпись: через «Добавить файлы…» или «Добавить папку…».</li>
  <li>Если подпись в другой папке — программа всё равно попробует её сопоставить,
      но при сомнениях можно открыть папку с документом и подписью отдельно.</li>
</ul>

<h3>Почему нельзя сохранить файл, если подпись просрочена или ошибочна?</h3>
<p>
  Программа не даёт поставить штамп, если подпись не подтверждена, документ не совпадает
  или сертификат недействителен. Это сделано, чтобы избежать введения в заблуждение — штамп
  должен отражать только корректно подтверждённую ЭЦП.
</p>

<h3>Изменяется ли исходный PDF-файл?</h3>
<p>
  Нет. Исходный PDF остаётся без изменений. Штамп добавляется только в копию, которая
  сохраняется под новым именем.
</p>

<h3>Сохраняются ли мои настройки?</h3>
<p>
  Да. Сохраняются:
</p>
<ul>
  <li>настройки шапки штампа (логотип, текст);</li>
  <li>флажок «Показывать время подписи на штампе»;</li>
  <li>выбранный режим сохранения (исходная папка или общая).</li>
</ul>

</body>
</html>
